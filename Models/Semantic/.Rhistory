mean(overlaps)
g+geom_point(pch='.')+scale_y_log10()+geom_smooth()
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
#g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
#g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
kmin = 0;freqmin = 50;edge_th = 50;kmaxdec=0.2;freqmaxdec=0.2
prefix = paste0('_full_100000_kmin',kmin,'_kmaxdec',kmaxdec,'_freqmin',freqmin,'_freqmaxdec',freqmaxdec,'_eth',edge_th,'.RData')
#prefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
##
#  1) First order interdisciplinarity
overlaps = c();cyears=c()
for(year in years){
show(year)
load(paste0('probas/relevant_',year,prefix))
#load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
probas=probas[,3:ncol(probas)]
#probas = m
for(i in 1:(ncol(probas)-1)){for(j in (i+1):ncol(probas)){
overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));cyears=append(cyears,year)
}}
}
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
#g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
kmin = 0;freqmin = 50;edge_th = 50;kmaxdec=0.25;freqmaxdec=0.25
prefix = paste0('_full_100000_kmin',kmin,'_kmaxdec',kmaxdec,'_freqmin',freqmin,'_freqmaxdec',freqmaxdec,'_eth',edge_th,'.RData')
#prefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
##
#  1) First order interdisciplinarity
overlaps = c();cyears=c()
for(year in years){
show(year)
load(paste0('probas/relevant_',year,prefix))
#load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
probas=probas[,3:ncol(probas)]
#probas = m
for(i in 1:(ncol(probas)-1)){for(j in (i+1):ncol(probas)){
overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));cyears=append(cyears,year)
}}
}
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
#g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
prefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
##
#  1) First order interdisciplinarity
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
for(i in 1:(ncol(probas)-1)){for(j in (i+1):ncol(probas)){
overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));cyears=append(cyears,year)
}}
}
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
#g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
sizeTh=10
prefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
for(i in 1:(ncol(probas)-1)){for(j in (i+1):ncol(probas)){
overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));cyears=append(cyears,year)
}}
}
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
probas = m
colSums(probas)
sum(colSums(probas))
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
for(i in 1:(ncol(probas)-1)){show(i);for(j in (i+1):ncol(probas)){
overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));cyears=append(cyears,year)
}}
}
100/70000
s=colSums(probas)
length(which(s[s>50]))
length(which(s>50))
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
inds = which(colSums(probas)>50)
currentovs = rep(0,ncol(probas)*(ncol(probas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){for(j in (i+1):length(inds)){
currentovs[k]=sum(probas[,i]*probas[,j])/nrow(probas);k=k+1
}}
# for(i in 1:(ncol(probas)-1)){show(i);for(j in (i+1):ncol(probas)){
#   overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(probas)*(ncol(probas)-1)/2))
}
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
inds = which(colSums(probas)>50)
currentovs = rep(0,ncol(probas)*(ncol(probas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){show(i);for(j in (i+1):length(inds)){
currentovs[k]=sum(probas[,i]*probas[,j])/nrow(probas);k=k+1
}}
# for(i in 1:(ncol(probas)-1)){show(i);for(j in (i+1):ncol(probas)){
#   overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(probas)*(ncol(probas)-1)/2))
}
length(inds)
overlaps = c();cyears=c()
for(year in years){
show(year)
#load(paste0('probas/relevant_',year,prefix))
load(paste0(prefix,year,'_sizeTh',sizeTh,'.RData'))
#probas=probas[,3:ncol(probas)]
probas = m
inds = which(colSums(probas)>50)
currentovs = rep(0,ncol(probas)*(ncol(probas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){show(i);for(j in (i+1):length(inds)){
currentovs[k]=sum(probas[,inds[i]]*probas[,inds[j]])/nrow(probas);k=k+1
}}
# for(i in 1:(ncol(probas)-1)){show(i);for(j in (i+1):ncol(probas)){
#   overlaps=append(overlaps,sum(probas[,i]*probas[,j])/nrow(probas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(probas)*(ncol(probas)-1)/2))
}
semprefix = paste0('_full_100000_kmin',kmin,'_kmaxdec',kmaxdec,'_freqmin',freqmin,'_freqmaxdec',freqmaxdec,'_eth',edge_th,'.RData')
technoprefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
res$technoprobas = m[rownames(semprobas),]
return(res)
}
##
#  1) First order interdisciplinarity
#  1.1) Macro-level
overlaps = c();cyears=c()
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
inds = which(colSums(technoprobas)>50)
currentovs = rep(0,ncol(technoprobas)*(ncol(technoprobas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){show(i);for(j in (i+1):length(inds)){
currentovs[k]=sum(technoprobas[,inds[i]]*technoprobas[,inds[j]])/nrow(technoprobas);k=k+1
}}
# for(i in 1:(ncol(semprobas)-1)){show(i);for(j in (i+1):ncol(semprobas)){
#   overlaps=append(overlaps,sum(semprobas[,i]*semprobas[,j])/nrow(semprobas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(technoprobas)*(ncol(technoprobas)-1)/2))
}
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
#g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
res$technoprobas = m[rownames(res$semprobas),]
return(res)
}
##
#  1) First order interdisciplinarity
#  1.1) Macro-level
overlaps = c();cyears=c()
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
inds = which(colSums(technoprobas)>50)
currentovs = rep(0,ncol(technoprobas)*(ncol(technoprobas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){show(i);for(j in (i+1):length(inds)){
currentovs[k]=sum(technoprobas[,inds[i]]*technoprobas[,inds[j]])/nrow(technoprobas);k=k+1
}}
# for(i in 1:(ncol(semprobas)-1)){show(i);for(j in (i+1):ncol(semprobas)){
#   overlaps=append(overlaps,sum(semprobas[,i]*semprobas[,j])/nrow(semprobas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(technoprobas)*(ncol(technoprobas)-1)/2))
}
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
#g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
rownames(m)
load(paste0('probas/relevant_',year,semprefix))
rownames(probas)
as.numeric(rownames(probas))
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
rownames(res$semprobas)=as.numeric(rownames(res$semprobas))
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
res$technoprobas = m
rownames(res$technoprobas)=as.numeric(rownames(res$technoprobas))
res$technoprobas=res$technoprobas[rownames(res$semprobas),]
return(res)
}
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
rownames(res$semprobas)=as.numeric(rownames(res$semprobas))
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
res$technoprobas = m
rownames(res$technoprobas)=as.numeric(rownames(res$technoprobas))
rownames(res$semprobas)
rownames(res$technoprobas)
res$technoprobas=res$technoprobas[as.numeric(rownames(res$semprobas)),]
db='relevant_full_50000_eth50_nonfiltdico'
dbparams = 'relevant_full_50000_eth50_nonfiltdico_kmin0_kmax1200_freqmin50_freqmax10000_eth100'
load(paste0('probas/',dbparams,'.RData'))
setwd(paste0(Sys.getenv('CS_HOME'),'/Cybergeo/cybergeo20/HyperNetwork/Models/Analysis'))
source('networkConstruction.R')
db='relevant_full_50000_eth50_nonfiltdico'
dbparams = 'relevant_full_50000_eth50_nonfiltdico_kmin0_kmax1200_freqmin50_freqmax10000_eth100'
load(paste0('probas/',dbparams,'.RData'))
load(paste0('processed/',db,'.RData'))
keyword_dico=res$keyword_dico;g=res$g;rm(res);gc()
them_probas = probas
load(paste0(Sys.getenv('CS_HOME'),'/Cybergeo/cybergeo20/HyperNetwork/Data/nw/citationNetwork.RData'))
citadjacency = get.adjacency(gcitation,sparse=TRUE)
rownames(citadjacency)
names(keyword_dico)
gc()
setwd(paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Models/Semantic'))
years = 1976:2012
kmin = 0;freqmin = 50;edge_th = 50;kmaxdec=0.25;freqmaxdec=0.25
sizeTh=10
semprefix = paste0('_full_100000_kmin',kmin,'_kmaxdec',kmaxdec,'_freqmin',freqmin,'_freqmaxdec',freqmaxdec,'_eth',edge_th,'.RData')
technoprefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
year:1976
year=1976
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
rownames(res$semprobas)=as.numeric(rownames(res$semprobas))
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
res$technoprobas = m
rownames(res$technoprobas)=as.numeric(rownames(res$technoprobas))
which(is.na(as.numeric(rownames(res$technoprobas))))
rownames(res$technoprobas)
res$technoprobas=res$technoprobas[rownames(res$semprobas),]
m
m["3944074",]
rbind(m,rep(0,ncol(m)))
setdiff
setdiff(rownames(res$semprobas),rownames(m))
rowstoadd=setdiff(rownames(res$semprobas),rownames(m))
m=rbind(m,matrix(0,length(rowstoadd),ncol(m)));rownames(m)[(nrow(m)-length(rowstoadd)+1):nrow(m)]=rowstoadd
m
res$technoprobas = m
return(res)
years = 1976:2012
kmin = 0;freqmin = 50;edge_th = 50;kmaxdec=0.25;freqmaxdec=0.25
sizeTh=10
semprefix = paste0('_full_100000_kmin',kmin,'_kmaxdec',kmaxdec,'_freqmin',freqmin,'_freqmaxdec',freqmaxdec,'_eth',edge_th,'.RData')
technoprefix=paste0(Sys.getenv('CS_HOME'),'/PatentsMining/Data/processed/classes/technoPerYear/technoProbas_')
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
rowstoadd=setdiff(rownames(res$semprobas),rownames(m))
m=rbind(m,matrix(0,length(rowstoadd),ncol(m)));rownames(m)[(nrow(m)-length(rowstoadd)+1):nrow(m)]=rowstoadd
res$technoprobas = m
return(res)
}
overlaps = c();cyears=c()
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
inds = which(colSums(technoprobas)>50)
currentovs = rep(0,ncol(technoprobas)*(ncol(technoprobas)-1)/2)
k=1
for(i in 1:(length(inds)-1)){show(i);for(j in (i+1):length(inds)){
currentovs[k]=sum(technoprobas[,inds[i]]*technoprobas[,inds[j]])/nrow(technoprobas);k=k+1
}}
# for(i in 1:(ncol(semprobas)-1)){show(i);for(j in (i+1):ncol(semprobas)){
#   overlaps=append(overlaps,sum(semprobas[,i]*semprobas[,j])/nrow(semprobas));
# }}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(technoprobas)*(ncol(technoprobas)-1)/2))
}
save(overlaps,cyears,file='res/techno_overlaps.RData')
inds=1:length(overlaps)#overlaps>0
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=years,y=overlaps))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
#g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
cyears
g=ggplot(data.frame(overlaps=overlaps[inds],years=cyears[inds]),aes(x=overlaps,colour=years))
g+geom_density(alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_density(alpha=0.25)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_point(aes(x=years,y=overlaps),pch='.')+scale_y_log10()+stat_smooth()
g=ggplot(data.frame(overlap=overlaps[inds],year=cyears[inds]),aes(x=year,y=overlap))
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
inds=overlaps>0#1:length(overlaps)
overlaps[overlaps==1e-10]=0
inds=overlaps>0#1:length(overlaps)
length(which(inds))
g=ggplot(data.frame(overlap=overlaps[inds],year=cyears[inds]),aes(x=year,y=overlap))
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
inds=1:length(overlaps)#
inds=1:length(overlaps)#
overlaps[overlaps==0]=1e-10
g=ggplot(data.frame(overlap=overlaps[inds],year=as.character(cyears[inds])),aes(x=overlap,colour=year))
g+geom_density(alpha=0.25)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
origs=c();years=c();types=c();
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
origs = append(origs,1 - rowSums(semprobas^2));types=append(types,rep("semantic",nrow(semprobas)))
origs = append(origs,1 - rowSums(technoprobas^2));types=append(types,rep("techno",nrow(technoprobas)))
years=append(years,rep(year,nrow(semprobas)+nrow(technoprobas)))
}
g=ggplot(data.frame(originality=origs,year=years,type=types))
g+geom_density(aes(x=origs,colour=year,linetype=type))
origs=c();years=c();types=c();
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
origs = append(origs,1 - rowSums(semprobas^2));types=append(types,rep("semantic",nrow(semprobas)))
origs = append(origs,1 - rowSums(technoprobas^2));types=append(types,rep("techno",nrow(technoprobas)))
years=append(years,rep(year,nrow(semprobas)+nrow(technoprobas)))
}
g=ggplot(data.frame(originality=origs,year=years,type=types))
g+geom_density(aes(x=origs,colour=year))
g=ggplot(data.frame(originality=origs,year=as.character(years),type=types[types=="semantic"]))
g+geom_density(aes(x=originality,colour=year))
g=ggplot(data.frame(originality=origs,year=as.character(years),type=types[types=="semantic"]),aes(x=originality,colour=year))
g+geom_density()
df = data.frame(originality=origs,year=as.character(years),type=types[types=="semantic"])
g=ggplot(df,aes(x=originality,colour=year))
g+geom_density()
g=ggplot(df,aes(x=origs,colour=year))
g+geom_density()
origs
origs=c();years=c();types=c();
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
origs = append(origs,1 - rowSums(semprobas^2));types=append(types,rep("semantic",nrow(semprobas)))
origs = append(origs,1 - rowSums(technoprobas^2));types=append(types,rep("techno",nrow(technoprobas)))
years=append(years,rep(year,nrow(semprobas)+nrow(technoprobas)))
}
origs
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
rowstoadd=setdiff(rownames(res$semprobas),rownames(m))
m=rbind(m,matrix(0,length(rowstoadd),ncol(m)));rownames(m)[(nrow(m)-length(rowstoadd)+1):nrow(m)]=rowstoadd
res$technoprobas = m[rownames(res$semprobas)]
return(res)
}
years
years = 1976:2012
origs=c();cyears=c();types=c();
origs=c();cyears=c();types=c();
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
origs = append(origs,1 - rowSums(semprobas^2));types=append(types,rep("semantic",nrow(semprobas)))
origs = append(origs,1 - rowSums(technoprobas^2));types=append(types,rep("techno",nrow(technoprobas)))
cyears=append(cyears,rep(year,nrow(semprobas)+nrow(technoprobas)))
}
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
rowstoadd=setdiff(rownames(res$semprobas),rownames(m))
m=rbind(m,matrix(0,length(rowstoadd),ncol(m)));rownames(m)[(nrow(m)-length(rowstoadd)+1):nrow(m)]=rowstoadd
rownames(res$semprobas)
res$technoprobas = m[rownames(res$semprobas)]
m[rownames(res$semprobas)]
res$technoprobas = m[rownames(res$semprobas),]
loadProbas<-function(year){
show(year)
res=list()
load(paste0('probas/relevant_',year,semprefix))
res$semprobas=probas[,3:ncol(probas)]
load(paste0(technoprefix,year,'_sizeTh',sizeTh,'.RData'))
rowstoadd=setdiff(rownames(res$semprobas),rownames(m))
m=rbind(m,matrix(0,length(rowstoadd),ncol(m)));rownames(m)[(nrow(m)-length(rowstoadd)+1):nrow(m)]=rowstoadd
res$technoprobas = m[rownames(res$semprobas),]
return(res)
}
origs=c();cyears=c();types=c();
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
origs = append(origs,1 - rowSums(semprobas^2));types=append(types,rep("semantic",nrow(semprobas)))
origs = append(origs,1 - rowSums(technoprobas^2));types=append(types,rep("techno",nrow(technoprobas)))
cyears=append(cyears,rep(year,nrow(semprobas)+nrow(technoprobas)))
}
df = data.frame(origs,as.character(years),type=types[types=="semantic"])
g=ggplot(df,aes(x=origs,colour=year))
g+geom_density()
df = data.frame(origs[types=="semantic"],as.character(years[types=="semantic"]),type=types[types=="semantic"])
g=ggplot(df,aes(x=origs,colour=year))
g+geom_density()
df = data.frame(originality=origs[types=="semantic"],year=as.character(years[types=="semantic"]),type=types[types=="semantic"])
g=ggplot(df,aes(x=originality,colour=year))
g+geom_density()
nrow(df)
g=ggplot(df)
g+geom_density(aes(x=originality,colour=year))
df = data.frame(originality=origs,year=as.character(years),type=types)
df = data.frame(originality=origs,year=as.character(years))
df = data.frame(originality=origs[types=="semantic"],year=as.character(cyears[types=="semantic"]),type=types[types=="semantic"])
g=ggplot(df)
g+geom_density(aes(x=originality,colour=year))
df = data.frame(originality=origs[types=="techno"],year=as.character(cyears[types=="techno"]),type=types[types=="semantic"])
g=ggplot(df)
g+geom_density(aes(x=originality,colour=year))
overlaps=c();cyears=c()
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
# all couples (i\in sem, j\in techno)
inds = which(colSums(technoprobas)>100)
currentovs = rep(0,ncol(technoprobas)*ncol(semprobas))
k=1
for(i in 1:ncol(semprobas)){show(i);for(j in inds){
currentovs[k]=sum(semprobas[,i]*technoprobas[,inds[j]])/nrow(technoprobas);k=k+1
}}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(technoprobas)*ncol(semprobas)))
}
years
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
inds = which(colSums(technoprobas)>100)
inds
currentovs = rep(0,ncol(technoprobas)*ncol(semprobas))
k=1
for(i in 1:ncol(semprobas)){show(i);for(j in inds){
currentovs[k]=sum(semprobas[,i]*technoprobas[,inds[j]])/nrow(technoprobas);k=k+1
}}
overlaps=c();cyears=c()
for(year in years){
res = loadProbas(year);technoprobas=res$technoprobas;semprobas=res$semprobas
# all couples (i\in sem, j\in techno)
inds = which(colSums(technoprobas)>100)
currentovs = rep(0,ncol(technoprobas)*ncol(semprobas))
k=1
for(i in 1:ncol(semprobas)){show(i);for(j in inds){
currentovs[k]=sum(semprobas[,i]*technoprobas[,j])/nrow(technoprobas);k=k+1
}}
overlaps=append(overlaps,currentovs)
cyears=append(cyears,rep(year,ncol(technoprobas)*ncol(semprobas)))
}
inds=overlaps>0
g=ggplot(data.frame(overlaps=overlaps[inds],cyears=cyears[inds]),aes(x=cyears,y=overlaps))
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
g=ggplot(data.frame(overlaps=overlaps[inds],cyears=cyears[inds]))#,aes(x=cyears,y=overlaps))
g+geom_density(aes(x=overlaps,colour=years),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g+geom_density(aes(x=overlaps,colour=cyears),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
g=ggplot(data.frame(overlaps=overlaps[inds],cyears=as.character(cyears[inds])))#,aes(x=cyears,y=overlaps))
g+geom_density(aes(x=overlaps,colour=cyears),alpha=0.25,adjust=0.75)+scale_x_log10()+xlab("overlap")+ylab("density")#+scale_y_log10()
load(file='res/techno_overlaps.RData')
inds=overlaps>0#1:length(overlaps)#
g=ggplot(data.frame(overlap=overlaps[inds],year=as.character(cyears[inds])),aes(x=year,y=overlap))
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
g=ggplot(data.frame(overlap=overlaps[inds],year=cyears[inds]),aes(x=year,y=overlap))
g+geom_point(pch='.')+scale_y_log10()+stat_smooth()
